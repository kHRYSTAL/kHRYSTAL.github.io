<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>造轮子</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://baladuu.com/"/>
  <updated>2017-06-07T07:20:26.000Z</updated>
  <id>http://baladuu.com/</id>
  
  <author>
    <name>kHRYSTAL</name>
    <email>723526676@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>android WebView使用内置资源</title>
    <link href="http://baladuu.com/2017/06/07/20170607/"/>
    <id>http://baladuu.com/2017/06/07/20170607/</id>
    <published>2017-06-07T07:12:06.000Z</published>
    <updated>2017-06-07T07:20:26.000Z</updated>
    
    <content type="html">&lt;p&gt;webView 使用客户端内置资源 需要调用&lt;code&gt;shouldInterceptRequest(WebView view, String url)&lt;/code&gt;方法&lt;br&gt;但5.0版本后新增&lt;code&gt;shouldInterceptRequest(WebView view, WebResourceRequest request)&lt;/code&gt;方法&lt;br&gt;与废弃方法参数不同 且&lt;code&gt;request.getUrl()&lt;/code&gt;方法必须api在21以上&lt;/p&gt;
&lt;p&gt;&lt;code&gt;shouldInterceptRequest(WebView view, WebResourceRequest request)&lt;/code&gt; super中会调用&lt;br&gt;&lt;code&gt;shouldInterceptRequest(WebView view, String url)&lt;/code&gt; 因此直接在废弃的方法中实现即可&lt;/p&gt;
&lt;p&gt;示例:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; * 拦截字体库url 替换为本地ttf文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; */&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@Override&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;public WebResourceResponse shouldInterceptRequest(WebView view, String url) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    WebResourceResponse response = null;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if (!StringUtil.isNullOrEmpty(url) &amp;amp;&amp;amp; url.contains(&amp;quot;SongTi.ttf&amp;quot;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        try &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            InputStream localCopy = context.getAssets().open(FontsUtil.PATH_SONG_TI);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            if (Build.VERSION.SDK_INT &amp;gt;= Build.VERSION_CODES.LOLLIPOP) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                int statusCode = 200;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                String reasonPhase = &amp;quot;OK&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                Map&amp;lt;String, String&amp;gt; responseHeaders = new HashMap&amp;lt;String, String&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                responseHeaders.put(&amp;quot;Access-Control-Allow-Origin&amp;quot;, &amp;quot;*&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                response = new WebResourceResponse(&amp;quot;application/x-font-ttf&amp;quot;, &amp;quot;UTF-8&amp;quot;, statusCode, reasonPhase, responseHeaders, localCopy);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                response = new WebResourceResponse(&amp;quot;application/x-font-ttf&amp;quot;, &amp;quot;UTF-8&amp;quot;, localCopy);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; catch (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            MLog.e(TAG, &amp;quot;shouldInterceptRequest:&amp;quot;, e, e.getMessage());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            response = super.shouldInterceptRequest(view, url);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; else &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        response = super.shouldInterceptRequest(view, url);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return response;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;需要注意需要区分当前系统版本， 5.0以上webview需要增加header和statusCode 否则认为响应失败&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;webView 使用客户端内置资源 需要调用&lt;code&gt;shouldInterceptRequest(WebView view, String url)&lt;/code&gt;方法&lt;br&gt;但5.0版本后新增&lt;code&gt;shouldInterceptRequest(WebView vi
    
    </summary>
    
      <category term="Android" scheme="http://baladuu.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://baladuu.com/tags/Android/"/>
    
      <category term="program" scheme="http://baladuu.com/tags/program/"/>
    
  </entry>
  
  <entry>
    <title>泛型实例化</title>
    <link href="http://baladuu.com/2016/12/29/20161229/"/>
    <id>http://baladuu.com/2016/12/29/20161229/</id>
    <published>2016-12-29T03:04:01.000Z</published>
    <updated>2016-12-29T03:07:45.000Z</updated>
    
    <content type="html">&lt;p&gt;需求: 没有Adapter 之前都是用的String 现在要求使用泛型POJO&lt;br&gt;但是代码中有需要泛型实例化的部分&lt;br&gt;工程中所有的Bean都是Serializable序列化的 与Parcelable不冲突&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;public class TagGroup&amp;lt;T extends TagGroup.TagAble&amp;gt; extends ViewGroup &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    public interface TagAble extends Parcelable &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        public String id();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        public String name();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    private Class&amp;lt;T&amp;gt; clazz;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    public void setClazz(Class&amp;lt;T&amp;gt; clazz) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        this.clazz = clazz;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    private T getInstanceOfT()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            throws InstantiationException, IllegalAccessException &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        return clazz.newInstance();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    @SuppressWarnings(&amp;quot;unchecked&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    private T[] getArrayInstanceOfT(int s) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        return (T[]) Array.newInstance(clazz, s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;需求: 没有Adapter 之前都是用的String 现在要求使用泛型POJO&lt;br&gt;但是代码中有需要泛型实例化的部分&lt;br&gt;工程中所有的Bean都是Serializable序列化的 与Parcelable不冲突&lt;/p&gt;
&lt;figure class=&quot;highlight p
    
    </summary>
    
      <category term="Android" scheme="http://baladuu.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://baladuu.com/tags/Android/"/>
    
      <category term="Java" scheme="http://baladuu.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>React Native 踩坑之旅</title>
    <link href="http://baladuu.com/2016/09/23/20160923/"/>
    <id>http://baladuu.com/2016/09/23/20160923/</id>
    <published>2016-09-22T17:53:40.000Z</published>
    <updated>2016-09-26T15:54:12.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;本文长期更新 始于微信小程序刺激本人学习React Native&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;搭建环境-运行Demo&quot;&gt;&lt;a href=&quot;#搭建环境-运行Demo&quot; class=&quot;headerlink&quot; title=&quot;搭建环境 运行Demo&quot;&gt;&lt;/a&gt;搭建环境 运行Demo&lt;/h3&gt;&lt;p&gt;搭建环境参照&lt;a href=&quot;http://reactnative.cn/docs/0.31/getting-started.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这篇链接&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;因为做 nodejs 微信后台和 android 很多东西都装过了&lt;/p&gt;
&lt;p&gt;只需要装react-native-cli, flow, watchman&lt;/p&gt;
&lt;p&gt;环境变量之前我配置过了&lt;/p&gt;
&lt;p&gt;android studio里需要再下载这些&lt;br&gt;&lt;img src=&quot;http://7xujzs.com1.z0.glb.clouddn.com/QQ20160923-1@2x.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;因为我使用atom编辑器 所以也把Nuclide装上了&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;按照教程建了个AwesomeProject项目&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;react-native init AwesomeProject&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cd AwesomeProject&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;react-native run-android&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;执行报错 提示&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;* What went wrong:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;A problem occurred evaluating project &amp;apos;:app&amp;apos;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt; SDK location not found. Define location with sdk.dir in the local.properties file or with an ANDROID_HOME environment variable.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;* Try:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;BUILD FAILED&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Total time: 11.387 secs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Could not install the app on the device, read the error above for details.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Make sure you have an Android emulator running or a device connected and have&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set up your Android development environment:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;https://facebook.github.io/react-native/docs/android-setup.html&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;于是在android下建了local.properties &lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sdk.dir=/Users/kHRYSTAL/Library/Android/sdk&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;还把gradle改成了1.2.3 因为教程评论说1.3.0报错(现在都2.14.1了好嘛..)&lt;/p&gt;
&lt;p&gt;再次执行 模拟器和真机都能显示了 但是是红色背景报了一个JsBridgeException去stackflow上查了几个解决方式&lt;/p&gt;
&lt;p&gt;最后 解决办法是在android/app/src/main下建立assets文件夹&lt;br&gt;命令行执行&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;react-native bundle --platform android --dev false --entry-file index.android.js --bundle-output android/app/src/main/assets/index.android.bundle --assets-dest android/app/src/main/res/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重新运行成功 真机没有菜单键 不能呼出调试菜单 还是用模拟器调试吧&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文长期更新 始于微信小程序刺激本人学习React Native&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;搭建环境-运行Demo&quot;&gt;&lt;a href=&quot;#搭建环境-运行Demo&quot; class=&quot;headerlink&quot; title=&quot;搭建环境 运行Demo&quot;&gt;&lt;/a&gt;搭建环境 运行Demo&lt;/h3&gt;&lt;p&gt;搭建环境参照&lt;a href=&quot;http://reactnative.cn/docs/0.31/getting-started.html&quot;&gt;这篇链接&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;因为做 nodejs 微信后台和 android 很多东西都装过了&lt;/p&gt;
&lt;p&gt;只需要装react-native-cli, flow, watchman&lt;/p&gt;
&lt;p&gt;环境变量之前我配置过了&lt;/p&gt;
&lt;p&gt;android studio里需要再下载这些&lt;br&gt;&lt;img src=&quot;http://7xujzs.com1.z0.glb.clouddn.com/QQ20160923-1@2x.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;因为我使用atom编辑器 所以也把Nuclide装上了&lt;br&gt;
    
    </summary>
    
      <category term="React Native" scheme="http://baladuu.com/categories/React-Native/"/>
    
    
      <category term="program" scheme="http://baladuu.com/tags/program/"/>
    
      <category term="React Native" scheme="http://baladuu.com/tags/React-Native/"/>
    
  </entry>
  
  <entry>
    <title>Android so文件冲突与缺失解决</title>
    <link href="http://baladuu.com/2016/09/13/20160913/"/>
    <id>http://baladuu.com/2016/09/13/20160913/</id>
    <published>2016-09-13T04:00:18.000Z</published>
    <updated>2016-09-13T05:07:39.000Z</updated>
    
    <content type="html">&lt;h4 id=&quot;项目文件&quot;&gt;&lt;a href=&quot;#项目文件&quot; class=&quot;headerlink&quot; title=&quot;项目文件&quot;&gt;&lt;/a&gt;项目文件&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;高德地图 &lt;/p&gt;
&lt;p&gt;  高德地图so并不是全平台的 只有armeabi文件夹 其中3D地图so文件可以按32位 64位放到其他平台文件夹中&lt;br&gt;  但是导航只能放到armeabi中(官方文档说明)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;极光推送&lt;/p&gt;
&lt;p&gt;  极光推送so为全平台    &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;融云&lt;/p&gt;
&lt;p&gt;  融云so为全平台&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;问题复现-测试机器三星s6&quot;&gt;&lt;a href=&quot;#问题复现-测试机器三星s6&quot; class=&quot;headerlink&quot; title=&quot;问题复现 测试机器三星s6&quot;&gt;&lt;/a&gt;问题复现 测试机器三星s6&lt;/h4&gt;&lt;p&gt;不考虑 x86(模拟器) mips(平板)架构前提下, 单只说armeabi。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;若遵循最少原则 只保留armeabi文件夹，按理说应该64位兼容32位，但是在64位机型编译后直接报错找不到jpush。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当把3D地图 导航拷贝到v7-a v8-a文件夹后，再次编译 报jpush.service.n.b()报空指针 不能启动极光PushService。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;若去掉高德sdk,保留极光推送与融云SDK正常。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;若只保留高德sdk,导航在armeabi下正常 拷贝到armeabi-v7a -v8a 导航错误 3D地图正常。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;若只去掉融云，保留高德与jpush，同1。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;    
&lt;h4 id=&quot;原因分析&quot;&gt;&lt;a href=&quot;#原因分析&quot; class=&quot;headerlink&quot; title=&quot;原因分析&quot;&gt;&lt;/a&gt;原因分析&lt;/h4&gt;&lt;p&gt;排除融云出现冲突问题,可能导致问题发生的原因有:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;jpush 与 高德地图 文件或函数冲突&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;jpush 32位 so文件与 64位机型不兼容&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;解决办法&quot;&gt;&lt;a href=&quot;#解决办法&quot; class=&quot;headerlink&quot; title=&quot;解决办法&quot;&gt;&lt;/a&gt;解决办法&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;通过原因1测试.将高德地图导航so文件动态编译 放到assets下运行时通过文件流读取 进行初始化&lt;br&gt;问题1复现 问题未解决 此原因排除。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;通过原因2测试.在defaultConfig中强制将所有架构需要编译so指向armeabi，且只保留armeabi文件夹&lt;br&gt;问题解决 armeabi 64位机型测试融云正常,jpush正常,导航正常。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;解决代码&quot;&gt;&lt;a href=&quot;#解决代码&quot; class=&quot;headerlink&quot; title=&quot;解决代码&quot;&gt;&lt;/a&gt;解决代码&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;app/build.gradle&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;android &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    defaultConfig &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ndk &amp;#123;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        	abiFilters &amp;quot;armeabi&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ｝&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;gradle.properties&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;android.useDeprecatedNdk=true&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;顺便测了leancloud IM +push 与高德没有冲突 但是从9月1日开始定量收费&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;如果有更好解决方式或理解错误请回复和指正 谢谢&lt;/em&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;项目文件&quot;&gt;&lt;a href=&quot;#项目文件&quot; class=&quot;headerlink&quot; title=&quot;项目文件&quot;&gt;&lt;/a&gt;项目文件&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;高德地图 &lt;/p&gt;
&lt;p&gt;  高德地图so并不是全平台的 只有armeabi文件夹 其中3D地图so文件可以按32位 64位放到其他平台文件夹中&lt;br&gt;  但是导航只能放到armeabi中(官方文档说明)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;极光推送&lt;/p&gt;
&lt;p&gt;  极光推送so为全平台    &lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;融云&lt;/p&gt;
&lt;p&gt;  融云so为全平台&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;问题复现-测试机器三星s6&quot;&gt;&lt;a href=&quot;#问题复现-测试机器三星s6&quot; class=&quot;headerlink&quot; title=&quot;问题复现 测试机器三星s6&quot;&gt;&lt;/a&gt;问题复现 测试机器三星s6&lt;/h4&gt;&lt;p&gt;不考虑 x86(模拟器) mips(平板)架构前提下, 单只说armeabi。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;若遵循最少原则 只保留armeabi文件夹，按理说应该64位兼容32位，但是在64位机型编译后直接报错找不到jpush。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;当把3D地图 导航拷贝到v7-a v8-a文件夹后，再次编译 报jpush.service.n.b()报空指针 不能启动极光PushService。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;若去掉高德sdk,保留极光推送与融云SDK正常。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;若只保留高德sdk,导航在armeabi下正常 拷贝到armeabi-v7a -v8a 导航错误 3D地图正常。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;若只去掉融云，保留高德与jpush，同1。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="Android" scheme="http://baladuu.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://baladuu.com/tags/Android/"/>
    
      <category term="bug fixed" scheme="http://baladuu.com/tags/bug-fixed/"/>
    
  </entry>
  
  <entry>
    <title>android上进行https请求</title>
    <link href="http://baladuu.com/2016/07/15/20160715/"/>
    <id>http://baladuu.com/2016/07/15/20160715/</id>
    <published>2016-07-15T08:16:54.000Z</published>
    <updated>2016-09-13T05:10:46.000Z</updated>
    
    <content type="html">&lt;p&gt;最近接了个活，比较坑。老版本项目没有客户端且后台数据库是GBK2312的&lt;br&gt;好不容易填完坑以后又说要改成https还是自签名要验证的(要我说都忽略了屁事也没有，但还是得办人事不是？)&lt;/p&gt;
&lt;p&gt;之前用HttpUrlConnection自己封装了个HttpUtil 支持post， get，文件上传什么的 本来想按着hongyang的&lt;a href=&quot;http://blog.csdn.net/lmj623565791/article/details/48129405&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这篇文章&lt;/a&gt; 改成OkHttp的 但还是懒 决定还是用 HttpUrlConnection 网上查了很多&lt;br&gt;最后总结出来以下代码&lt;/p&gt;
&lt;h4 id=&quot;第一步-获取密钥库&quot;&gt;&lt;a href=&quot;#第一步-获取密钥库&quot; class=&quot;headerlink&quot; title=&quot;第一步 获取密钥库&quot;&gt;&lt;/a&gt;第一步 获取密钥库&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;//创建密钥库， 并将读取的证书导入密钥库 支持字符串导入 这里写的是文件路径&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//KeyStore不支持JKS类型 已试验 PKCS12 没问题&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//load 第二个参数是密码 这里设置的为null&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;AssetManager am = context.getAssets();  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;InputStream ins = am.open(&amp;quot;cepath&amp;quot;);  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;InputStream ins = null;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        try &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ins = am.open(&amp;quot;&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            CertificateFactory cerFactory = CertificateFactory.getInstance(&amp;quot;X.509&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Certificate cer = cerFactory.generateCertificate(ins);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            KeyStore keyStore = KeyStore.getInstance(&amp;quot;PKCS12&amp;quot;, &amp;quot;BC&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            keyStore.load(null, null);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            keyStore.setCertificateEntry(&amp;quot;trust&amp;quot;, cer);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return keyStore;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; catch (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; finally &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ins.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h4 id=&quot;第二步-获取SSL工厂&quot;&gt;&lt;a href=&quot;#第二步-获取SSL工厂&quot; class=&quot;headerlink&quot; title=&quot;第二步 获取SSL工厂&quot;&gt;&lt;/a&gt;第二步 获取SSL工厂&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;KeyManagerFactory keyManagerFactory = KeyManagerFactory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                .getInstance(KeyManagerFactory.getDefaultAlgorithm());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;keyManagerFactory.init(keyStore,null);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;TrustManagerFactory trustManagerFactory = TrustManagerFactory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                .getInstance(TrustManagerFactory.getDefaultAlgorithm());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//初始化信任库 使用的也是之前的密钥                &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;trustManagerFactory.init(keyStore);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SSLContext sslCtx = SSLContext.getInstance(&amp;quot;TLS&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sslCtx.init(keyManagerFactory.getKeyManagers(),trustManagerFactory.getTrustManagers(), null);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;第三步-配置主机验证接口&quot;&gt;&lt;a href=&quot;#第三步-配置主机验证接口&quot; class=&quot;headerlink&quot; title=&quot;第三步 配置主机验证接口&quot;&gt;&lt;/a&gt;第三步 配置主机验证接口&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;private class CustomHostnameVerifier implements HostnameVerifier&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         @Override  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         public boolean verify(String hostname, SSLSession session) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                //这里配置验证规则 true验证成功 false失败 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                return true;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;第四步-配置HttpUrlConnection&quot;&gt;&lt;a href=&quot;#第四步-配置HttpUrlConnection&quot; class=&quot;headerlink&quot; title=&quot;第四步 配置HttpUrlConnection&quot;&gt;&lt;/a&gt;第四步 配置HttpUrlConnection&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;HttpsURLConnection.setDefaultSSLSocketFactory(sslContext&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    .getSocketFactory());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;HttpsURLConnection.setDefaultHostnameVerifier(new CustomHostnameVerifier());&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样就支持双向验证了&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;最近接了个活，比较坑。老版本项目没有客户端且后台数据库是GBK2312的&lt;br&gt;好不容易填完坑以后又说要改成https还是自签名要验证的(要我说都忽略了屁事也没有，但还是得办人事不是？)&lt;/p&gt;
&lt;p&gt;之前用HttpUrlConnection自己封装了个HttpUtil 支持post， get，文件上传什么的 本来想按着hongyang的&lt;a href=&quot;http://blog.csdn.net/lmj623565791/article/details/48129405&quot;&gt;这篇文章&lt;/a&gt; 改成OkHttp的 但还是懒 决定还是用 HttpUrlConnection 网上查了很多&lt;br&gt;最后总结出来以下代码&lt;/p&gt;
&lt;h4 id=&quot;第一步-获取密钥库&quot;&gt;&lt;a href=&quot;#第一步-获取密钥库&quot; class=&quot;headerlink&quot; title=&quot;第一步 获取密钥库&quot;&gt;&lt;/a&gt;第一步 获取密钥库&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;//创建密钥库， 并将读取的证书导入密钥库 支持字符串导入 这里写的是文件路径&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//KeyStore不支持JKS类型 已试验 PKCS12 没问题&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//load 第二个参数是密码 这里设置的为null&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;AssetManager am = context.getAssets();  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;InputStream ins = am.open(&amp;quot;cepath&amp;quot;);  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;InputStream ins = null;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        try &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ins = am.open(&amp;quot;&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            CertificateFactory cerFactory = CertificateFactory.getInstance(&amp;quot;X.509&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            Certificate cer = cerFactory.generateCertificate(ins);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            KeyStore keyStore = KeyStore.getInstance(&amp;quot;PKCS12&amp;quot;, &amp;quot;BC&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            keyStore.load(null, null);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            keyStore.setCertificateEntry(&amp;quot;trust&amp;quot;, cer);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            return keyStore;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; catch (Exception e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            e.printStackTrace();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125; finally &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ins.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Android" scheme="http://baladuu.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://baladuu.com/tags/Android/"/>
    
      <category term="program" scheme="http://baladuu.com/tags/program/"/>
    
  </entry>
  
  <entry>
    <title>awesome-python3-webapp</title>
    <link href="http://baladuu.com/2016/06/04/20160604/"/>
    <id>http://baladuu.com/2016/06/04/20160604/</id>
    <published>2016-06-04T03:44:36.000Z</published>
    <updated>2016-09-13T05:10:59.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;跟着-廖雪峰老师从头学了一遍python3&quot;&gt;&lt;a href=&quot;#跟着-廖雪峰老师从头学了一遍python3&quot; class=&quot;headerlink&quot; title=&quot;跟着@廖雪峰老师从头学了一遍python3&quot;&gt;&lt;/a&gt;跟着&lt;a href=&quot;http://www.liaoxuefeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;@廖雪峰&lt;/a&gt;老师从头学了一遍python3&lt;/h3&gt;&lt;p&gt;4天时间做了后面的实例，受益匪浅&lt;/p&gt;
&lt;p&gt;如果单纯的使用RESTfulAPI 用这个框架完全没有问题&lt;/p&gt;
&lt;p&gt;不过有些偏低层了&lt;/p&gt;
&lt;p&gt;完全用协程和aiohttp，aiomysql封装后台&lt;/p&gt;
&lt;p&gt;jinja2，uikit做前台&lt;/p&gt;
&lt;p&gt;部署脚本太好用了&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/kHRYSTAL/awesome_python3_webapp&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;项目地址&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://182.92.199.62/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;线上地址&lt;/a&gt;&lt;br&gt;(就买了一个月的阿里云)&lt;/p&gt;
&lt;p&gt;不过也踩到了很多坑 比如3.5之前不支持&lt;code&gt;async&lt;/code&gt;,&lt;code&gt;await&lt;/code&gt;关键字&lt;br&gt;部署时发现版本是3.4临时改成了&lt;code&gt;@asyncio.coroutine&lt;/code&gt;和&lt;code&gt;yield from&lt;/code&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;今天踩过的坑-都是曾经脑子里进的水&quot;&gt;&lt;a href=&quot;#今天踩过的坑-都是曾经脑子里进的水&quot; class=&quot;headerlink&quot; title=&quot;今天踩过的坑 都是曾经脑子里进的水&quot;&gt;&lt;/a&gt;今天踩过的坑 都是曾经脑子里进的水&lt;/h3&gt;&lt;p&gt;希望以后脑子不要进水了&lt;/p&gt;
&lt;p&gt;开始重新学&lt;code&gt;Django&lt;/code&gt; &lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;跟着-廖雪峰老师从头学了一遍python3&quot;&gt;&lt;a href=&quot;#跟着-廖雪峰老师从头学了一遍python3&quot; class=&quot;headerlink&quot; title=&quot;跟着@廖雪峰老师从头学了一遍python3&quot;&gt;&lt;/a&gt;跟着&lt;a href=&quot;http://www.liaoxuefeng.com/&quot;&gt;@廖雪峰&lt;/a&gt;老师从头学了一遍python3&lt;/h3&gt;&lt;p&gt;4天时间做了后面的实例，受益匪浅&lt;/p&gt;
&lt;p&gt;如果单纯的使用RESTfulAPI 用这个框架完全没有问题&lt;/p&gt;
&lt;p&gt;不过有些偏低层了&lt;/p&gt;
&lt;p&gt;完全用协程和aiohttp，aiomysql封装后台&lt;/p&gt;
&lt;p&gt;jinja2，uikit做前台&lt;/p&gt;
&lt;p&gt;部署脚本太好用了&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/kHRYSTAL/awesome_python3_webapp&quot;&gt;项目地址&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://182.92.199.62/&quot;&gt;线上地址&lt;/a&gt;&lt;br&gt;(就买了一个月的阿里云)&lt;/p&gt;
&lt;p&gt;不过也踩到了很多坑 比如3.5之前不支持&lt;code&gt;async&lt;/code&gt;,&lt;code&gt;await&lt;/code&gt;关键字&lt;br&gt;部署时发现版本是3.4临时改成了&lt;code&gt;@asyncio.coroutine&lt;/code&gt;和&lt;code&gt;yield from&lt;/code&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://baladuu.com/categories/python/"/>
    
    
      <category term="music" scheme="http://baladuu.com/tags/music/"/>
    
      <category term="python" scheme="http://baladuu.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>AndroidCoroutine</title>
    <link href="http://baladuu.com/2016/05/30/20160530/"/>
    <id>http://baladuu.com/2016/05/30/20160530/</id>
    <published>2016-05-29T17:17:24.000Z</published>
    <updated>2016-06-04T03:47:53.000Z</updated>
    
    <content type="html">&lt;p&gt;闲的蛋疼 准备写个协程的库 先把仓库开了 慢慢研究慢慢写吧&lt;br&gt;不过貌似协程在客户端上需求也不大 而且可能又是造Kilim的轮子&lt;/p&gt;
&lt;p&gt;目的:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对象的方法内部可中断 同时执行内部其他方法或其他对象方法能够将中断时数据保存，并能够恢复&lt;/li&gt;
&lt;li&gt;不使用锁的生产者－消费者模式&lt;/li&gt;
&lt;li&gt;类似generator，能够yield，break，continue&lt;/li&gt;
&lt;li&gt;能够判断是否完成 提供抽象公共对象&lt;/li&gt;
&lt;li&gt;参考Kilim的Scheduler&lt;/li&gt;
&lt;li&gt;提供线程控制者&lt;/li&gt;
&lt;li&gt;减少线程频繁切换&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;当然，也不一定会写&quot;&gt;&lt;a href=&quot;#当然，也不一定会写&quot; class=&quot;headerlink&quot; title=&quot;当然，也不一定会写&quot;&gt;&lt;/a&gt;当然，也不一定会写&lt;/h2&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;闲的蛋疼 准备写个协程的库 先把仓库开了 慢慢研究慢慢写吧&lt;br&gt;不过貌似协程在客户端上需求也不大 而且可能又是造Kilim的轮子&lt;/p&gt;
&lt;p&gt;目的:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对象的方法内部可中断 同时执行内部其他方法或其他对象方法能够将中断时数据保存，并能够恢复&lt;/l
    
    </summary>
    
      <category term="Android" scheme="http://baladuu.com/categories/Android/"/>
    
    
      <category term="Android" scheme="http://baladuu.com/tags/Android/"/>
    
      <category term="program" scheme="http://baladuu.com/tags/program/"/>
    
  </entry>
  
  <entry>
    <title>500 Miles</title>
    <link href="http://baladuu.com/2016/05/25/20160526/"/>
    <id>http://baladuu.com/2016/05/25/20160526/</id>
    <published>2016-05-25T06:39:21.000Z</published>
    <updated>2016-09-25T06:39:38.000Z</updated>
    
    <content type="html">&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;298&quot; height=&quot;52&quot; src=&quot;http://music.163.com/outchain/player?type=2&amp;id=27759600&amp;auto=1&amp;height=32&quot;&gt;&lt;/iframe&gt;</content>
    
    <summary type="html">
    
      &lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;298&quot; height=&quot;52&quot; src=&quot;http://music.163.com/outchain/player?type=
    
    </summary>
    
      <category term="music" scheme="http://baladuu.com/categories/music/"/>
    
    
      <category term="music" scheme="http://baladuu.com/tags/music/"/>
    
  </entry>
  
  <entry>
    <title>换地方了</title>
    <link href="http://baladuu.com/2016/05/25/20160525/"/>
    <id>http://baladuu.com/2016/05/25/20160525/</id>
    <published>2016-05-24T16:21:05.000Z</published>
    <updated>2016-09-13T05:11:47.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;img src=&quot;http://7xujzs.com1.z0.glb.clouddn.com/001.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;我最终还是开github pages了。百度空间再见&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7xujzs.com1.z0.glb.clouddn.com/001.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;我最终还是开github pages了。百度空间再见&lt;/p&gt;

    
    </summary>
    
      <category term="essay" scheme="http://baladuu.com/categories/essay/"/>
    
    
      <category term="essay" scheme="http://baladuu.com/tags/essay/"/>
    
  </entry>
  
</feed>
